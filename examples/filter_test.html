<!DOCTYPE html>
<html>
<head>

<meta charset=utf-8 />
<style type="text/css">
.text {
	font-family: "Arial";
	font-size: 22px;
	color: #00AEEF;
	padding:20px;
}
</style>

<title>Filter Test</title>

<script src="../dist/Breakout.js"></script>
<script src="libs/jquery-1.6.3.min.js"></script>
<script type="text/javascript">
$(document).ready(function() {

	// to do: plot data to a scope-like graph

	// dependencies
	// declare these variables so you don't have
	// to type the full namespace
	var IOBoard = BREAKOUT.IOBoard;
	var IOBoardEvent = BREAKOUT.IOBoardEvent;
	var Event = JSUTILS.Event;
	var Scaler = BREAKOUT.filters.Scaler;
	var Convolution = BREAKOUT.filters.Convolution;
	var TriggerPoint = BREAKOUT.filters.TriggerPoint;

	var arduino = new IOBoard("localhost", 8887);
	var triggerPoint;
	
	arduino.addEventListener(IOBoardEvent.READY, onReady);

	function onReady(event) {
					
		arduino.removeEventListener(IOBoardEvent.READY, onReady);		

		triggerPoint = new TriggerPoint([[0.15, 0],[0.8, 0]]);

		// need to enable an analog pin in order to read it
		arduino.enableAnalogPin(0);
		var pot = arduino.getAnalogPin(0);
		//pot.addFilter(new Convolution(Convolution.MOVING_AVERAGE))
		//pot.addFilter(new Scaler(0, 1, 0, 10, Scaler.LINEAR));
		pot.addFilter(triggerPoint);		
		//pot.addFilter(new TriggerPoint([0.5, 0.1]));
		//pot.addFilter(new TriggerPoint());	
		pot.addEventListener(Event.CHANGE, onPotChange);

		//setTimeout(addPoint, 4000);
		//setTimeout(removePoint, 8000);
		//setTimeout(removeAllPoints, 12000);
				
	}
	
	function onPotChange(event) {
		var pin = event.target;
		var analogData = "pot value: " + pin.value.toFixed(3) + 
			"\tmin = " + pin.minimum.toFixed(3) + "\tmax = " + 
			pin.maximum.toFixed(3) + "\tavg = " + pin.average.toFixed(3)
		
		$('#potData').html(analogData);	
		$('#preFilterData').html("pre-filter value: " + pin.preFilterValue.toFixed(3));
	}

	function addPoint() {
		triggerPoint.addPoint(0.5, 0.05);
	}

	function removePoint() {
		triggerPoint.removePoint(0.15);
	}

	function removeAllPoints() {
		triggerPoint.removeAllPoints();
	}
			
});
</script>

</head>
<body>
  
	<div id="potData" class="text">pot value:</div>
	<div id="preFilterData" class="text">pre-filter value:</div>
  
</body>
</html>â€‹